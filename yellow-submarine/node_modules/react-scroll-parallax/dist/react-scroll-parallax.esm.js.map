{"version":3,"file":"react-scroll-parallax.esm.js","sources":["../src/utils/removeUndefinedObjectKeys.ts","../src/helpers/getIsolatedParallaxProps.ts","../src/components/Parallax/hooks.ts","../src/context/ParallaxContext.ts","../src/hooks/useParallaxController.ts","../src/hooks/useParallax.ts","../src/components/Parallax/index.tsx","../src/components/ParallaxBanner/helpers/getExpandedStyle.ts","../src/components/ParallaxBanner/helpers/getImageStyle.ts","../src/components/ParallaxBanner/components/ParallaxBannerLayer.tsx","../src/components/ParallaxBanner/index.tsx","../src/components/ParallaxProvider/helpers.ts","../src/components/ParallaxProvider/index.tsx"],"sourcesContent":["export function removeUndefinedObjectKeys(obj: { [key: string]: any }) {\n  Object.keys(obj).forEach((key) =>\n    obj[key] === undefined && delete obj[key]\n  );\n  return obj;\n}\n","import { ParallaxElementConfig } from 'parallax-controller';\nimport { removeUndefinedObjectKeys } from '../utils/removeUndefinedObjectKeys';\n\nexport function getIsolatedParallaxProps(props: any): {\n  parallaxProps: ParallaxElementConfig;\n  rest: Record<string, any>;\n} {\n  const {\n    disabled,\n    easing,\n    endScroll,\n    onChange,\n    onEnter,\n    onExit,\n    onProgressChange,\n    opacity,\n    rootMargin,\n    rotate,\n    rotateX,\n    rotateY,\n    rotateZ,\n    scale,\n    scaleX,\n    scaleY,\n    scaleZ,\n    shouldAlwaysCompleteAnimation,\n    shouldDisableScalingTranslations,\n    speed,\n    startScroll,\n    targetElement,\n    translateX,\n    translateY,\n    ...rest\n  } = props;\n\n  const parallaxProps = removeUndefinedObjectKeys({\n    disabled,\n    easing,\n    endScroll,\n    onChange,\n    onEnter,\n    onExit,\n    onProgressChange,\n    opacity,\n    rootMargin,\n    rotate,\n    rotateX,\n    rotateY,\n    rotateZ,\n    scale,\n    scaleX,\n    scaleY,\n    scaleZ,\n    shouldAlwaysCompleteAnimation,\n    shouldDisableScalingTranslations,\n    speed,\n    startScroll,\n    targetElement,\n    translateX,\n    translateY,\n  });\n\n  return {\n    parallaxProps,\n    rest,\n  };\n}\n","import { ParallaxController } from 'parallax-controller';\nimport { useEffect } from 'react';\n\nexport function useVerifyController(controller: ParallaxController | unknown) {\n  useEffect(() => {\n    const isServer = typeof window === 'undefined';\n    // Make sure the provided controller is an instance of the Parallax Controller\n    const isInstance = controller instanceof ParallaxController;\n    // Throw if neither context or global is available\n    if (!isServer && !controller && !isInstance) {\n      throw new Error(\n        \"Must wrap your application's <Parallax /> components in a <ParallaxProvider />.\"\n      );\n    }\n  }, [controller]);\n}\n","import React from 'react';\nimport { ParallaxController } from 'parallax-controller';\n\nexport const ParallaxContext = React.createContext<ParallaxController | null>(\n  null\n);\n","import { useContext } from 'react';\nimport { ParallaxController } from 'parallax-controller';\nimport { ParallaxContext } from '../context/ParallaxContext';\n\nexport function useParallaxController(): ParallaxController | null {\n  const parallaxController = useContext(ParallaxContext);\n  const isServer = typeof window === 'undefined';\n  if (isServer) {\n    return null;\n  }\n\n  if (!parallaxController) {\n    throw new Error(\n      'Could not find `react-scroll-parallax` context value. Please ensure the component is wrapped in a <ParallaxProvider>'\n    );\n  }\n\n  return parallaxController;\n}\n","import { CreateElementOptions, Element } from 'parallax-controller';\nimport { useEffect, useRef, useState } from 'react';\nimport { useVerifyController } from '../components/Parallax/hooks';\nimport { ParallaxProps } from '../components/Parallax/types';\nimport { getIsolatedParallaxProps } from '../helpers/getIsolatedParallaxProps';\nimport { useParallaxController } from './useParallaxController';\n\nexport function useParallax<T extends HTMLElement>(props: ParallaxProps) {\n  const controller = useParallaxController();\n  const ref = useRef<T>(null);\n  const { parallaxProps } = getIsolatedParallaxProps(props);\n\n  useVerifyController(controller);\n\n  const [element, setElement] = useState<Element>();\n\n  // create element\n  useEffect(() => {\n    let newElement: Element | undefined;\n    if (ref.current instanceof HTMLElement) {\n      const options: CreateElementOptions = {\n        el: ref.current,\n        props: parallaxProps,\n      };\n      newElement = controller?.createElement(options);\n      setElement(newElement);\n    } else {\n      throw new Error(\n        'You must assign the ref returned by the useParallax() hook to an HTML Element.'\n      );\n    }\n\n    return () => {\n      if (newElement) {\n        controller?.removeElementById(newElement.id);\n      }\n    };\n  }, []);\n\n  // update element\n  useEffect(() => {\n    if (element) {\n      if (props.disabled) {\n        controller?.resetElementStyles(element);\n        controller?.updateElementPropsById(element.id, parallaxProps);\n      } else {\n        controller?.updateElementPropsById(element.id, parallaxProps);\n      }\n    }\n  }, [\n    props.disabled,\n    props.easing,\n    props.endScroll,\n    props.onChange,\n    props.onEnter,\n    props.onExit,\n    props.onProgressChange,\n    props.opacity,\n    props.rootMargin,\n    props.rotate,\n    props.rotateX,\n    props.rotateY,\n    props.rotateZ,\n    props.scale,\n    props.scaleX,\n    props.scaleY,\n    props.scaleZ,\n    props.shouldAlwaysCompleteAnimation,\n    props.shouldDisableScalingTranslations,\n    props.speed,\n    props.startScroll,\n    props.targetElement,\n    props.translateX,\n    props.translateY,\n  ]);\n\n  return { ref, controller, element };\n}\n","import React, { PropsWithChildren } from 'react';\nimport { getIsolatedParallaxProps } from '../../helpers/getIsolatedParallaxProps';\nimport { useParallax } from '../../hooks/useParallax';\nimport { ParallaxProps } from './types';\n\nexport function Parallax(props: PropsWithChildren<ParallaxProps>) {\n  const { parallaxProps, rest } = getIsolatedParallaxProps(props);\n  const { ref } = useParallax<HTMLDivElement>(parallaxProps);\n  return (\n    <div ref={ref} {...rest}>\n      {props.children}\n    </div>\n  );\n}\n","import { parseValueAndUnit } from 'parallax-controller';\nimport { BannerLayer } from '../types';\n\nconst FALLBACK_RECT = {\n  height: 0,\n};\n\ntype ExpandedStyle = {\n  top?: string;\n  bottom?: string;\n};\n\nexport function getExpandedStyle(layer: BannerLayer): ExpandedStyle {\n  if (Array.isArray(layer.translateY)) {\n    const translateYStart = parseValueAndUnit(layer.translateY[0]);\n    const translateYEnd = parseValueAndUnit(layer.translateY[1]);\n\n    if (translateYStart.unit === 'px' && translateYEnd.unit === 'px') {\n      return {\n        top: `${Math.abs(translateYEnd.value) * -1}px`,\n        bottom: `${Math.abs(translateYStart.value) * -1}px`,\n      };\n    }\n\n    if (translateYStart.unit === '%' && translateYEnd.unit === '%') {\n      const clientRect =\n        layer.targetElement?.getBoundingClientRect() ?? FALLBACK_RECT;\n      const top = Math.abs(clientRect.height * 0.01 * translateYEnd.value) * -1;\n      const bottom =\n        Math.abs(clientRect.height * 0.01 * translateYStart.value) * -1;\n      return {\n        top: `${top}px`,\n        bottom: `${bottom}px`,\n      };\n    }\n  }\n\n  if (layer.speed) {\n    const speed = layer.speed || 0;\n    const absSpeed = Math.abs(speed) * 10 * -1;\n\n    return {\n      top: `${absSpeed}px`,\n      bottom: `${absSpeed}px`,\n    };\n  }\n\n  return {};\n}\n","import { BannerLayer } from '../types';\n\nexport function getImageStyle(layer: BannerLayer) {\n  return layer.image\n    ? {\n        backgroundImage: `url(${layer.image})`,\n        backgroundPosition: 'center',\n        backgroundSize: 'cover',\n      }\n    : {};\n}\n","import React, { CSSProperties } from 'react';\nimport { useParallax } from '../../../hooks/useParallax';\nimport { getIsolatedParallaxProps } from '../../../helpers/getIsolatedParallaxProps';\nimport { getExpandedStyle } from '../helpers/getExpandedStyle';\nimport { getImageStyle } from '../helpers/getImageStyle';\nimport { BannerLayer } from '../types';\n\nconst absoluteStyle: CSSProperties = {\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  right: 0,\n  bottom: 0,\n};\n\nexport const ParallaxBannerLayer = (\n  props: BannerLayer & { testId?: string }\n) => {\n  const { parallaxProps, rest } = getIsolatedParallaxProps(props);\n  const {\n    children,\n    disabled,\n    style,\n    expanded = true,\n    image,\n    testId,\n    ...divProps\n  } = rest;\n\n  const imageStyle = getImageStyle(props);\n  const expandedStyle = expanded ? getExpandedStyle(props) : {};\n  const parallax = useParallax<HTMLDivElement>({\n    targetElement: props.targetElement,\n    shouldDisableScalingTranslations: true,\n    ...parallaxProps,\n  });\n\n  return (\n    <div\n      data-testid={testId}\n      ref={parallax.ref}\n      style={{\n        ...imageStyle,\n        ...absoluteStyle,\n        ...expandedStyle,\n        ...style,\n      }}\n      {...divProps}\n    >\n      {rest.children}\n    </div>\n  );\n};\n","import React, {\n  PropsWithChildren,\n  CSSProperties,\n  useEffect,\n  useRef,\n  useState,\n  ReactElement,\n} from 'react';\nimport { ParallaxBannerLayer } from './components/ParallaxBannerLayer';\nimport { ParallaxBannerProps } from './types';\n\nconst containerStyle: CSSProperties = {\n  position: 'relative',\n  overflow: 'hidden',\n  width: '100%',\n};\n\nexport const ParallaxBanner = (\n  props: PropsWithChildren<ParallaxBannerProps>\n) => {\n  const [targetElement, setTargetElement] =\n    useState<HTMLDivElement | null>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    setTargetElement(containerRef.current);\n  }, []);\n  const {\n    disabled: disableAllLayers,\n    style: rootStyle,\n    layers = [],\n    ...rootRest\n  } = props;\n\n  function renderLayers() {\n    if (targetElement) {\n      const shouldUseLayers = layers && layers.length > 0;\n      if (shouldUseLayers) {\n        return layers.map((layer, i) => (\n          <ParallaxBannerLayer\n            {...layer}\n            targetElement={targetElement}\n            key={`layer-${i}`}\n            testId={`layer-${i}`}\n          />\n        ));\n      }\n    }\n    return null;\n  }\n\n  function renderChildren() {\n    if (targetElement) {\n      return React.Children.map(props.children, (child) => {\n        const item = child as ReactElement<\n          PropsWithChildren<{ targetElement: any }>\n        >;\n        // adds the targetElement prop to any ParallaxBannerLayer components\n        if (item?.type === ParallaxBannerLayer) {\n          const clone = React.cloneElement(item, {\n            targetElement,\n          });\n          return clone;\n        }\n        return child;\n      });\n    }\n    return null;\n  }\n  return (\n    <div\n      ref={containerRef}\n      style={{ ...containerStyle, ...rootStyle }}\n      {...rootRest}\n    >\n      {/* Using the `layers` prop to define children */}\n      {renderLayers()}\n      {/* Using children to compose layers */}\n      {renderChildren()}\n    </div>\n  );\n};\n","import {\n  ParallaxController,\n  ParallaxControllerOptions,\n} from 'parallax-controller';\n\nexport const createController = (options: ParallaxControllerOptions) => {\n  // Don't initialize on the server\n  const isServer = typeof window === 'undefined';\n\n  if (!isServer) {\n    // Must not be the server so kick it off...\n    return ParallaxController.init(options);\n  }\n  return null;\n};\n","import React, { Component } from 'react';\n\nimport { ParallaxContext } from '../../context/ParallaxContext';\nimport { ParallaxController, ScrollAxis } from 'parallax-controller';\nimport { ParallaxProviderProps } from './types';\nimport { createController } from './helpers';\n\nexport class ParallaxProvider extends Component<ParallaxProviderProps, {}> {\n  static defaultProps = {\n    scrollAxis: ScrollAxis.vertical,\n  };\n\n  controller: ParallaxController | null;\n\n  constructor(props: ParallaxProviderProps) {\n    super(props);\n    this.controller = createController({\n      scrollAxis: props.scrollAxis,\n      scrollContainer: props.scrollContainer,\n      disabled: props.isDisabled,\n    });\n  }\n\n  componentDidUpdate(prevProps: ParallaxProviderProps) {\n    if (\n      prevProps.scrollContainer !== this.props.scrollContainer &&\n      this.props.scrollContainer\n    ) {\n      this.controller?.updateScrollContainer(this.props.scrollContainer);\n    }\n\n    if (prevProps.isDisabled !== this.props.isDisabled) {\n      if (this.props.isDisabled) {\n        this.controller?.disableParallaxController();\n      }\n      if (!this.props.isDisabled) {\n        this.controller?.enableParallaxController();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    // @ts-ignore\n    this.controller = this.controller.destroy();\n  }\n\n  render() {\n    const { children } = this.props;\n    return (\n      // @ts-ignore\n      <ParallaxContext.Provider value={this.controller}>\n        {children}\n      </ParallaxContext.Provider>\n    );\n  }\n}\n"],"names":["removeUndefinedObjectKeys","obj","Object","keys","forEach","key","undefined","getIsolatedParallaxProps","props","disabled","easing","endScroll","onChange","onEnter","onExit","onProgressChange","opacity","rootMargin","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","shouldAlwaysCompleteAnimation","shouldDisableScalingTranslations","speed","startScroll","targetElement","translateX","translateY","rest","parallaxProps","useVerifyController","controller","useEffect","isServer","window","isInstance","ParallaxController","Error","ParallaxContext","React","createContext","useParallaxController","parallaxController","useContext","useParallax","ref","useRef","useState","element","setElement","newElement","current","HTMLElement","options","el","createElement","removeElementById","id","resetElementStyles","updateElementPropsById","Parallax","children","FALLBACK_RECT","height","getExpandedStyle","layer","Array","isArray","translateYStart","parseValueAndUnit","translateYEnd","unit","top","Math","abs","value","bottom","clientRect","getBoundingClientRect","absSpeed","getImageStyle","image","backgroundImage","backgroundPosition","backgroundSize","absoluteStyle","position","left","right","ParallaxBannerLayer","style","expanded","testId","divProps","imageStyle","expandedStyle","parallax","containerStyle","overflow","width","ParallaxBanner","setTargetElement","containerRef","rootStyle","layers","rootRest","renderLayers","shouldUseLayers","length","map","i","renderChildren","Children","child","item","type","clone","cloneElement","createController","init","ParallaxProvider","scrollAxis","scrollContainer","isDisabled","componentDidUpdate","prevProps","updateScrollContainer","disableParallaxController","enableParallaxController","componentWillUnmount","destroy","render","Provider","Component","ScrollAxis","vertical"],"mappings":"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"}